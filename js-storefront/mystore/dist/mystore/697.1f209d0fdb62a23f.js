"use strict";(self.webpackChunkmystore_6_3=self.webpackChunkmystore_6_3||[]).push([[697],{8697:(Ge,I,u)=>{u.r(I),u.d(I,{UserProfileModule:()=>Je});var e=u(4650),p=u(6895),g=u(5391),s=u(8849),l=u(9144),b=u(591),H=u(2654),B=u(6053),k=u(7224),N=u(2986),x=u(2994),_=u(4850),O=u(2198),A=u(7545),f=u(6538),i=u(4006),Z=u(4459);function V(o,a){1&o&&(e.TgZ(0,"div")(1,"div",10),e._UZ(2,"cx-spinner"),e.qZA()())}function W(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"p",12),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA()(),e.TgZ(4,"div",13)(5,"button",14),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.closeAccount())}),e._uU(6),e.ALo(7,"cxTranslate"),e.qZA(),e.TgZ(8,"button",15),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.dismissModal("Cancel"))}),e._uU(9),e.ALo(10,"cxTranslate"),e.qZA()()}2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,3,"closeAccount.confirmAccountClosureMessage")," "),e.xp6(4),e.hij(" ",e.lcZ(7,5,"closeAccount.closeMyAccount")," "),e.xp6(3),e.hij(" ",e.lcZ(10,7,"common.cancel")," "))}function K(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e.NdJ("esc",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.dismissModal("Escape click"))}),e.TgZ(2,"div",2)(3,"div",3)(4,"h3",4),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.dismissModal("Cross click"))}),e.ALo(8,"cxTranslate"),e.TgZ(9,"span",6),e._UZ(10,"cx-icon",7),e.qZA()()(),e.YNc(11,V,3,0,"div",8),e.ALo(12,"async"),e.YNc(13,W,11,9,"ng-template",null,9,e.W1O),e.qZA()(),e.BQk()}if(2&o){const t=e.MAs(14),r=e.oxw();e.xp6(1),e.Q6J("cxFocus",r.focusConfig),e.xp6(4),e.hij(" ",e.lcZ(6,6,"closeAccount.confirmAccountClosure")," "),e.xp6(2),e.uIk("aria-label",e.lcZ(8,8,"common.close")),e.xp6(3),e.Q6J("type",r.iconTypes.CLOSE),e.xp6(1),e.Q6J("ngIf",e.lcZ(12,10,r.isLoading$))("ngIfElse",t)}}const ee=["element"],P=function(){return{cxRoute:"home"}};function te(o,a){1&o&&e._UZ(0,"cx-spinner",7)}const J=function(){return{cxRoute:"login"}};function oe(o,a){if(1&o&&(e.TgZ(0,"label"),e._UZ(1,"input",25),e.TgZ(2,"span",21),e._uU(3),e.qZA()()),2&o){const t=a.ngIf,r=e.oxw(2);e.xp6(1),e.Q6J("checked",r.isConsentGiven(t.consent)),e.xp6(2),e.hij(" ",t.template," ")}}function re(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"label")(2,"input",28),e.NdJ("change",function(n){e.CHM(t);const c=e.oxw().index,d=e.oxw(3);return e.KtG(d.updateAdditionalConsents(n,c))}),e.qZA(),e.TgZ(3,"span",21),e._uU(4),e.qZA(),e._UZ(5,"cx-form-errors",12),e.qZA()()}if(2&o){const t=a.ngIf,r=e.oxw(),n=r.index,c=r.$implicit,d=e.oxw().ngIf;e.xp6(2),e.Q6J("required",d[n].required)("name",t)("formControlName",n),e.xp6(2),e.hij(" ",d[n].template.description," "),e.xp6(1),e.Q6J("control",c)}}function se(o,a){if(1&o&&(e.TgZ(0,"div",17),e.YNc(1,re,6,5,"div",18),e.qZA()),2&o){const t=a.index,r=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",null==r[t]||null==r[t].template?null:r[t].template.id)}}function ne(o,a){if(1&o&&(e.TgZ(0,"div",26),e.YNc(1,se,2,1,"div",27),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.additionalConsents.controls)}}const D=function(o){return{ariaLabel:o}},ie=function(){return{cxRoute:"termsAndConditions"}};function ae(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"section",2),e._UZ(1,"div",3),e.ALo(2,"cxTranslate"),e.TgZ(3,"div",4)(4,"div",5)(5,"div",6)(6,"form",7),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.submitForm())}),e.TgZ(7,"div",8)(8,"label")(9,"span",9),e._uU(10),e.ALo(11,"cxTranslate"),e.qZA(),e._UZ(12,"ng-select",10),e.ALo(13,"async"),e.ALo(14,"cxTranslate"),e.ALo(15,"cxTranslate"),e.qZA()(),e.TgZ(16,"div",8)(17,"label")(18,"span",9),e._uU(19),e.ALo(20,"cxTranslate"),e.qZA(),e._UZ(21,"input",11),e.ALo(22,"cxTranslate"),e._UZ(23,"cx-form-errors",12),e.qZA()(),e.TgZ(24,"div",8)(25,"label")(26,"span",9),e._uU(27),e.ALo(28,"cxTranslate"),e.qZA(),e._UZ(29,"input",13),e.ALo(30,"cxTranslate"),e._UZ(31,"cx-form-errors",12),e.qZA()(),e.TgZ(32,"div",8)(33,"label")(34,"span",9),e._uU(35),e.ALo(36,"cxTranslate"),e.qZA(),e._UZ(37,"input",14),e.ALo(38,"cxTranslate"),e._UZ(39,"cx-form-errors",12),e.qZA()(),e.TgZ(40,"div",8)(41,"label")(42,"span",9),e._uU(43),e.ALo(44,"cxTranslate"),e.qZA(),e._UZ(45,"input",15),e.ALo(46,"cxTranslate"),e.ALo(47,"cxTranslate"),e._UZ(48,"cx-form-errors",12),e.qZA()(),e.TgZ(49,"div",8)(50,"label")(51,"span",9),e._uU(52),e.ALo(53,"cxTranslate"),e.qZA(),e._UZ(54,"input",16),e.ALo(55,"cxTranslate"),e.ALo(56,"cxTranslate"),e._UZ(57,"cx-form-errors",12),e.qZA()(),e.TgZ(58,"div",8)(59,"div",17),e.YNc(60,oe,4,2,"label",18),e.ALo(61,"async"),e.qZA()(),e.YNc(62,ne,2,1,"div",19),e.TgZ(63,"div",8)(64,"div",17)(65,"label"),e._UZ(66,"input",20),e.TgZ(67,"span",21),e._uU(68),e.ALo(69,"cxTranslate"),e.TgZ(70,"a",22),e.ALo(71,"cxUrl"),e._uU(72),e.ALo(73,"cxTranslate"),e.qZA()(),e._UZ(74,"cx-form-errors",12),e.qZA()()(),e.TgZ(75,"button",23),e._uU(76),e.ALo(77,"cxTranslate"),e.qZA(),e.TgZ(78,"a",24),e.ALo(79,"cxUrl"),e._uU(80),e.ALo(81,"cxTranslate"),e.qZA()()()()()()}if(2&o){const t=e.oxw();e.xp6(1),e.uIk("aria-label",e.lcZ(2,34,"common.loaded")),e.xp6(5),e.Q6J("formGroup",t.registerForm),e.xp6(4),e.Oqu(e.lcZ(11,36,"register.title")),e.xp6(2),e.Q6J("clearable",!1)("items",e.lcZ(13,38,t.titles$))("placeholder",e.lcZ(14,40,"register.selectTitle"))("searchable",!1)("cxNgSelectA11y",e.VKq(82,D,e.lcZ(15,42,"register.title"))),e.xp6(7),e.Oqu(e.lcZ(20,44,"register.firstName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(22,46,"register.firstName.placeholder")),e.xp6(2),e.Q6J("control",t.registerForm.get("firstName")),e.xp6(4),e.Oqu(e.lcZ(28,48,"register.lastName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(30,50,"register.lastName.placeholder")),e.xp6(2),e.Q6J("control",t.registerForm.get("lastName")),e.xp6(4),e.Oqu(e.lcZ(36,52,"register.emailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(38,54,"register.emailAddress.placeholder")),e.xp6(2),e.Q6J("control",t.registerForm.get("email")),e.xp6(4),e.Oqu(e.lcZ(44,56,"register.password.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(46,58,"register.password.placeholder")),e.uIk("aria-label",e.lcZ(47,60,"register.password.placeholder")),e.xp6(3),e.Q6J("control",t.registerForm.get("password")),e.xp6(4),e.Oqu(e.lcZ(53,62,"register.confirmPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(55,64,"register.confirmPassword.placeholder")),e.uIk("aria-label",e.lcZ(56,66,"register.confirmPassword.placeholder")),e.xp6(3),e.Q6J("control",t.registerForm.get("passwordconf")),e.xp6(3),e.Q6J("ngIf",e.lcZ(61,68,t.anonymousConsent$)),e.xp6(2),e.Q6J("ngIf",t.additionalRegistrationConsents),e.xp6(6),e.hij(" ",e.lcZ(69,70,"register.confirmThatRead")," "),e.xp6(2),e.Q6J("routerLink",e.lcZ(71,72,e.DdM(84,ie))),e.xp6(2),e.hij(" ",e.lcZ(73,74,"register.termsAndConditions")," "),e.xp6(2),e.Q6J("control",t.registerForm.get("termsandconditions")),e.xp6(2),e.hij(" ",e.lcZ(77,76,"register.register")," "),e.xp6(2),e.Q6J("routerLink",e.lcZ(79,78,e.DdM(85,J))),e.xp6(2),e.Oqu(e.lcZ(81,80,"register.signIn"))}}function ce(o,a){1&o&&(e.TgZ(0,"div",29),e._UZ(1,"cx-spinner"),e.qZA())}function le(o,a){1&o&&e._UZ(0,"cx-spinner",2)}function de(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"form",3),e.NdJ("ngSubmit",function(){const c=e.CHM(t).ngIf,d=e.oxw();return e.KtG(d.onSubmit(c))}),e.TgZ(1,"label")(2,"span",4),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA(),e._UZ(5,"input",5),e.ALo(6,"cxTranslate"),e.ALo(7,"cxTranslate"),e._UZ(8,"cx-form-errors",6),e.qZA(),e.TgZ(9,"label")(10,"span",4),e._uU(11),e.ALo(12,"cxTranslate"),e.qZA(),e._UZ(13,"input",7),e.ALo(14,"cxTranslate"),e.ALo(15,"cxTranslate"),e._UZ(16,"cx-form-errors",6),e.qZA(),e.TgZ(17,"button",8),e._uU(18),e.ALo(19,"cxTranslate"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(3),e.Oqu(e.lcZ(4,11,"register.newPassword")),e.xp6(2),e.s9C("placeholder",e.lcZ(6,13,"register.password.placeholder")),e.uIk("aria-label",e.lcZ(7,15,"register.password.placeholder")),e.xp6(3),e.Q6J("control",t.form.get("password")),e.xp6(3),e.Oqu(e.lcZ(12,17,"register.passwordMinRequirements")),e.xp6(2),e.s9C("placeholder",e.lcZ(14,19,"register.confirmPassword.placeholder")),e.uIk("aria-label",e.lcZ(15,21,"register.confirmPassword.placeholder")),e.xp6(3),e.Q6J("control",t.form.get("passwordConfirm")),e.xp6(1),e.Q6J("disabled",t.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(19,23,"register.resetPassword")," ")}}function ue(o,a){1&o&&e._UZ(0,"cx-spinner",9)}function pe(o,a){1&o&&e._UZ(0,"cx-spinner",9)}function me(o,a){1&o&&e._UZ(0,"cx-spinner",11)}function fe(o,a){if(1&o&&(e.TgZ(0,"ng-option",12),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.name)}}const ge={launch:{CLOSE_ACCOUNT:{inline:!0,component:(()=>{class o{handleClick(t){t.target.tagName===this.el.nativeElement.tagName&&this.dismissModal("Cross click")}constructor(t,r,n,c,d,m,v){this.authService=t,this.globalMessageService=r,this.routingService=n,this.translationService=c,this.userProfile=d,this.launchDialogService=m,this.el=v,this.iconTypes=l.e1G,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0},this.loading$=new b.X(!1)}get isLoading$(){return this.loading$.asObservable()}ngOnInit(){this.isLoggedIn$=this.authService.isUserLoggedIn()}onSuccess(){this.dismissModal("Success"),this.translationService.translate("closeAccount.accountClosedSuccessfully").pipe((0,k.P)()).subscribe(t=>{this.globalMessageService.add(t,s.xUg.MSG_TYPE_CONFIRMATION)}),this.authService.coreLogout().then(()=>{this.routingService.go({cxRoute:"home"})})}onError(){this.dismissModal("Error"),this.translationService.translate("closeAccount.accountClosedFailure").pipe((0,k.P)()).subscribe(t=>{this.globalMessageService.add(t,s.xUg.MSG_TYPE_ERROR)})}dismissModal(t){this.launchDialogService.closeDialog(t)}closeAccount(){this.loading$.next(!0),this.userProfile.close().subscribe({next:()=>{this.onSuccess(),this.loading$.next(!1)},error:()=>{this.onError(),this.loading$.next(!1)}})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(s.e80),e.Y36(s.IWp),e.Y36(s.Znh),e.Y36(s.D7D),e.Y36(f.aT),e.Y36(l.Q3W),e.Y36(e.SBq))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-close-account-modal"]],hostBindings:function(t,r){1&t&&e.NdJ("click",function(c){return r.handleClick(c)})},decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-close-account-modal",3,"cxFocus","esc"],[1,"cx-close-account-modal-container"],[1,"cx-close-account-modal-header","cx-modal-header"],[1,"cx-close-account-modal-title"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[3,"type"],[4,"ngIf","ngIfElse"],["loaded",""],[1,"cx-spinner"],[1,"cx-close-account-modal-body","modal-body"],[1,"cx-confirmation"],[1,"cx-close-account-modal-footer","cx-modal-footer"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-block","btn-secondary",3,"click"]],template:function(t,r){1&t&&(e.YNc(0,K,15,12,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,r.isLoggedIn$))},dependencies:[p.O5,l.oJW,l.ORR,l.RRe,p.Ov,s.X$D],encapsulation:2,changeDetection:0}),o})(),dialogType:l.Myk.DIALOG}}};let he=(()=>{class o{constructor(t,r){this.launchDialogService=t,this.vcr=r}openModal(){this.launchDialogService.openDialog("CLOSE_ACCOUNT",this.element,this.vcr)?.pipe((0,N.q)(1)).subscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(l.Q3W),e.Y36(e.s_b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-close-account"]],viewQuery:function(t,r){if(1&t&&e.Gf(ee,5),2&t){let n;e.iGM(n=e.CRH())&&(r.element=n.first)}},decls:12,vars:10,consts:[[1,"col-lg-8","col-md-9"],[1,"row","cx-btn-group"],[1,"col-sm-6"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"click"],["element",""]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),e.ALo(4,"cxUrl"),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA()(),e.TgZ(7,"div",2)(8,"button",4,5),e.NdJ("click",function(){return r.openModal()}),e._uU(10),e.ALo(11,"cxTranslate"),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("routerLink",e.lcZ(4,3,e.DdM(9,P))),e.xp6(2),e.Oqu(e.lcZ(6,5,"common.cancel")),e.xp6(5),e.hij(" ",e.lcZ(11,7,"closeAccount.closeMyAccount")," "))},dependencies:[g.rH,s.l2T,s.X$D],encapsulation:2,changeDetection:0}),o})(),ve=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{CloseAccountComponent:{component:he,guards:[s.a1M]}}}),(0,s.i51)(ge)],imports:[p.ez,g.Bz,s.bhT,s.LUR,l.QX1,l.Fme,l.oPH]}),o})(),S=(()=>{class o{constructor(t,r,n,c){this.userPasswordService=t,this.routingService=r,this.authConfigService=n,this.globalMessage=c,this.busy$=new b.X(!1),this.isUpdating$=this.busy$.pipe((0,x.b)(d=>!0===d?this.form.disable():this.form.enable())),this.form=new i.nJ({userEmail:new i.p4("",[i.kI.required,l.kal.emailValidator])})}requestEmail(){this.form.valid?(this.busy$.next(!0),this.userPasswordService.requestForgotPasswordEmail(this.form.value.userEmail).subscribe({next:()=>this.onSuccess(),error:t=>this.onError(t)})):this.form.markAllAsTouched()}onSuccess(){this.globalMessage.add({key:"forgottenPassword.passwordResetEmailSent"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.redirect()}onError(t){this.busy$.next(!1)}redirect(){this.authConfigService.getOAuthFlow()===s.C8C.ResourceOwnerPasswordFlow&&this.routingService.go({cxRoute:"login"})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.dSP),e.LFG(s.IWp))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),xe=(()=>{class o{constructor(t){this.service=t,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.requestEmail()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(S))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-forgot-password"]],decls:17,vars:22,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","email","formControlName","userEmail",1,"form-control",3,"placeholder"],[3,"control"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(t,r){1&t&&(e.YNc(0,te,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label")(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e._UZ(9,"cx-form-errors",4),e.qZA(),e.TgZ(10,"a",5),e.ALo(11,"cxUrl"),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e.TgZ(14,"button",6),e._uU(15),e.ALo(16,"cxTranslate"),e.qZA()()),2&t&&(e.Q6J("ngIf",e.lcZ(1,9,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,11,"forgottenPassword.emailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,13,"forgottenPassword.emailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("userEmail")),e.xp6(1),e.Q6J("routerLink",e.lcZ(11,15,e.DdM(21,J))),e.xp6(2),e.Oqu(e.lcZ(13,17,"common.cancel")),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(16,19,"common.submit")," "))},dependencies:[p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,g.rH,l.Ahv,l.ORR,p.Ov,s.l2T,s.X$D],encapsulation:2,changeDetection:0}),o})(),Ce=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{ForgotPasswordComponent:{component:xe,guards:[s.aOY],providers:[{provide:S,useClass:S,deps:[f.LL,s.Znh,s.dSP,s.IWp]}]}}})],imports:[p.ez,i.UX,g.Bz,s.bhT,s.LUR,l.Fym,l.Fme]}),o})(),L=(()=>{class o{constructor(t,r,n){this.userRegisterFacade=t,this.globalMessageService=r,this.fb=n}register(t){return this.userRegisterFacade.register(t)}getTitles(){return this.userRegisterFacade.getTitles()}postRegisterMessage(){this.globalMessageService.add({key:"register.postRegisterMessage"},s.xUg.MSG_TYPE_CONFIRMATION)}getAdditionalConsents(){return[]}generateAdditionalConsentsFormControl(){return this.fb?.array([])??void 0}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.zm),e.LFG(s.IWp),e.LFG(i.QS))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),we=(()=>{class o{get additionalConsents(){return this.registerForm?.get("additionalConsents")}updateAdditionalConsents(t,r){const{checked:n}=t.target;this.registerForm.value.additionalConsents[r]=n}constructor(t,r,n,c,d,m,v){this.globalMessageService=t,this.fb=r,this.router=n,this.anonymousConsentsService=c,this.anonymousConsentsConfig=d,this.authConfigService=m,this.registerComponentService=v,this.isLoading$=new b.X(!1),this.subscription=new H.w,this.registerForm=this.fb.group({titleCode:[null],firstName:["",i.kI.required],lastName:["",i.kI.required],email:["",[i.kI.required,l.kal.emailValidator]],password:["",[i.kI.required,l.kal.passwordValidator]],passwordconf:["",i.kI.required],newsletter:new i.p4({value:!1,disabled:this.isConsentRequired()}),additionalConsents:this.registerComponentService.generateAdditionalConsentsFormControl?.()??this.fb.array([]),termsandconditions:[!1,i.kI.requiredTrue]},{validators:l.kal.passwordsMustMatch("password","passwordconf")})}ngOnInit(){this.titles$=this.registerComponentService.getTitles().pipe((0,_.U)(r=>r.sort(l.ke7))),this.subscription.add(this.globalMessageService.get().pipe((0,O.h)(r=>!!Object.keys(r).length)).subscribe(r=>{const n=r&&r[s.xUg.MSG_TYPE_ERROR];n&&n.some(c=>"This field is required."===c.raw)&&(this.globalMessageService.remove(s.xUg.MSG_TYPE_ERROR),this.globalMessageService.add({key:"register.titleRequired"},s.xUg.MSG_TYPE_ERROR))}));const t=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent??"";this.anonymousConsent$=(0,B.aj)([this.anonymousConsentsService.getConsent(t),this.anonymousConsentsService.getTemplate(t)]).pipe((0,_.U)(([r,n])=>({consent:r,template:n?.description?n.description:""}))),this.additionalRegistrationConsents=this.registerComponentService?.getAdditionalConsents()||[],this.subscription.add(this.registerForm.get("newsletter").valueChanges.subscribe(()=>{this.toggleAnonymousConsent()}))}submitForm(){this.registerForm.valid?this.registerUser():this.registerForm.markAllAsTouched()}registerUser(){this.isLoading$.next(!0),this.registerComponentService.register(this.collectDataFromRegisterForm(this.registerForm.value)).subscribe({next:()=>this.onRegisterUserSuccess(),complete:()=>this.isLoading$.next(!1),error:()=>this.isLoading$.next(!1)})}titleSelected(t){this.registerForm.controls.titleCode.setValue(t.code)}collectDataFromRegisterForm(t){const{firstName:r,lastName:n,email:c,password:d,titleCode:m}=t;return{firstName:r,lastName:n,uid:c.toLowerCase(),password:d,titleCode:m}}isConsentGiven(t){return this.anonymousConsentsService.isConsentGiven(t)}isConsentRequired(){const t=this.anonymousConsentsConfig?.anonymousConsents?.requiredConsents,r=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent;return!(!t||!r)&&t.includes(r)}onRegisterUserSuccess(){this.authConfigService.getOAuthFlow()===s.C8C.ResourceOwnerPasswordFlow&&this.router.go("login"),this.registerComponentService.postRegisterMessage()}toggleAnonymousConsent(){const t=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent;t&&(Boolean(this.registerForm.get("newsletter").value)?this.anonymousConsentsService.giveConsent(t):this.anonymousConsentsService.withdrawConsent(t))}ngOnDestroy(){this.subscription.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(s.IWp),e.Y36(i.QS),e.Y36(s.Znh),e.Y36(s.NpW),e.Y36(s.k0m),e.Y36(s.dSP),e.Y36(L))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-register"]],decls:4,vars:4,consts:[["class","cx-page-section container",4,"ngIf","ngIfElse"],["loading",""],[1,"cx-page-section","container"],["role","status"],[1,"row","justify-content-center"],[1,"col-md-6"],[1,"cx-section"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"label-content"],["bindLabel","name","bindValue","code","formControlName","titleCode","id","title-select",3,"clearable","items","placeholder","searchable","cxNgSelectA11y"],["required","true","type","text","name","firstname","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","text","name","lastname","formControlName","lastName",1,"form-control",3,"placeholder"],["required","true","type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],["required","true","type","password","name","password","formControlName","password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],["required","true","type","password","name","confirmpassword","formControlName","passwordconf","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"form-check"],[4,"ngIf"],["formArrayName","additionalConsents","class","form-group",4,"ngIf"],["required","true","type","checkbox","name","termsandconditions","formControlName","termsandconditions"],[1,"form-check-label"],["target","_blank","rel","noopener noreferrer",3,"routerLink"],["type","submit",1,"btn","btn-block","btn-primary"],[1,"cx-login-link","btn-link",3,"routerLink"],["type","checkbox","name","newsletter","formControlName","newsletter",1,"form-check-input",3,"checked"],["formArrayName","additionalConsents",1,"form-group"],["class","form-check",4,"ngFor","ngForOf"],["type","checkbox",3,"required","name","formControlName","change"],[1,"cx-spinner"]],template:function(t,r){if(1&t&&(e.YNc(0,ae,82,86,"section",0),e.ALo(1,"async"),e.YNc(2,ce,2,0,"ng-template",null,1,e.W1O)),2&t){const n=e.MAs(3);e.Q6J("ngIf",!e.lcZ(1,2,r.isLoading$))("ngIfElse",n)}},dependencies:[p.sg,p.O5,i._Y,i.Fj,i.Wl,i.JJ,i.JL,i.Q7,i.Zs,i.sg,i.u,i.CE,g.rH,l.ORR,l.Ahv,Z.w9,l.VnX,l.X84,p.Ov,s.l2T,s.X$D],encapsulation:2}),o})(),be=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{RegisterCustomerComponent:{component:we,guards:[s.aOY],providers:[{provide:L,useClass:L,deps:[f.zm,s.IWp,i.QS]}]}}})],imports:[p.ez,i.UX,g.Bz,s.bhT,s.LUR,l.Fme,l.Fym,Z.A0,l.LcC,l.Ird]}),o})(),F=(()=>{class o{constructor(t,r,n){this.userPasswordService=t,this.routingService=r,this.globalMessage=n,this.busy$=new b.X(!1),this.isUpdating$=this.busy$.pipe((0,x.b)(c=>!0===c?this.form.disable():this.form.enable())),this.resetToken$=this.routingService.getRouterState().pipe((0,_.U)(c=>c.state.queryParams.token)),this.form=new i.nJ({password:new i.p4("",[i.kI.required,l.kal.passwordValidator]),passwordConfirm:new i.p4("",i.kI.required)},{validators:l.kal.passwordsMustMatch("password","passwordConfirm")})}resetPassword(t){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const r=this.form.get("password").value;this.userPasswordService.reset(t,r).subscribe({next:()=>this.onSuccess(),error:n=>this.onError(n)})}onSuccess(){this.globalMessage.add({key:"forgottenPassword.passwordResetSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.redirect()}onError(t){this.busy$.next(!1),t instanceof s.YPQ&&(t.details??[]).forEach(r=>{r.message&&this.globalMessage.add({raw:r.message},s.xUg.MSG_TYPE_ERROR)})}redirect(){this.routingService.go({cxRoute:"login"})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.IWp))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),_e=(()=>{class o{constructor(t){this.service=t,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.token$=this.service.resetToken$}onSubmit(t){this.service.resetPassword(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(F))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-reset-password"]],hostAttrs:[1,"user-form"],decls:4,vars:6,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"overlay"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","password","formControlName","password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","password","formControlName","passwordConfirm","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-primary",3,"disabled"]],template:function(t,r){1&t&&(e.YNc(0,le,1,0,"cx-spinner",0),e.ALo(1,"async"),e.YNc(2,de,20,25,"form",1),e.ALo(3,"async")),2&t&&(e.Q6J("ngIf",e.lcZ(1,2,r.isUpdating$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,4,r.token$)))},dependencies:[p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.Ahv,l.ORR,l.X84,p.Ov,s.X$D],encapsulation:2,changeDetection:0}),o})(),Ae=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{ResetPasswordComponent:{component:_e,guards:[s.aOY],providers:[{provide:F,useClass:F,deps:[f.LL,s.Znh,s.IWp]}]}}})],imports:[p.ez,i.u5,i.UX,g.Bz,s.LUR,l.Fym,l.Fme,l.Ird]}),o})(),M=(()=>{class o{constructor(t,r,n,c,d){this.userEmail=t,this.routingService=r,this.globalMessageService=n,this.authService=c,this.authRedirectService=d,this.busy$=new b.X(!1),this.isUpdating$=this.busy$.pipe((0,x.b)(m=>!0===m?this.form.disable():this.form.enable())),this.form=new i.nJ({email:new i.p4("",[i.kI.required,l.kal.emailValidator]),confirmEmail:new i.p4("",[i.kI.required]),password:new i.p4("",[i.kI.required])},{validators:l.kal.emailsMustMatch("email","confirmEmail")})}save(){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const t=this.form.get("confirmEmail")?.value,r=this.form.get("password")?.value;this.userEmail.update(r,t).subscribe({next:()=>this.onSuccess(t),error:n=>this.onError(n)})}onSuccess(t){this.globalMessageService.add({key:"updateEmailForm.emailUpdateSuccess",params:{newUid:t}},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.authRedirectService.setRedirectUrl(this.routingService.getUrl({cxRoute:"home"})),this.authService.coreLogout().then(()=>{this.routingService.go({cxRoute:"login"},{state:{newUid:t}})})}onError(t){this.busy$.next(!1)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.PF),e.LFG(s.Znh),e.LFG(s.IWp),e.LFG(s.e80),e.LFG(s.FUY))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),Ze=(()=>{class o{constructor(t){this.service=t,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.save()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(M))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-update-email"]],hostAttrs:[1,"user-form"],decls:32,vars:39,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","email","name","confirmEmail","formControlName","confirmEmail",1,"form-control",3,"placeholder"],["required","true","type","password","name","password","formControlName","password","autocomplete","new-password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(t,r){1&t&&(e.YNc(0,ue,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label")(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e._UZ(9,"cx-form-errors",4),e.qZA(),e.TgZ(10,"label")(11,"span",2),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e._UZ(14,"input",5),e.ALo(15,"cxTranslate"),e._UZ(16,"cx-form-errors",4),e.qZA(),e.TgZ(17,"label")(18,"span",2),e._uU(19),e.ALo(20,"cxTranslate"),e.qZA(),e._UZ(21,"input",6),e.ALo(22,"cxTranslate"),e.ALo(23,"cxTranslate"),e._UZ(24,"cx-form-errors",4),e.qZA(),e.TgZ(25,"a",7),e.ALo(26,"cxUrl"),e._uU(27),e.ALo(28,"cxTranslate"),e.qZA(),e.TgZ(29,"button",8),e._uU(30),e.ALo(31,"cxTranslate"),e.qZA()()),2&t&&(e.Q6J("ngIf",e.lcZ(1,16,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,18,"updateEmailForm.newEmailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,20,"updateEmailForm.newEmailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("email")),e.xp6(3),e.Oqu(e.lcZ(13,22,"updateEmailForm.confirmNewEmailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(15,24,"updateEmailForm.confirmNewEmailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("confirmEmail")),e.xp6(3),e.Oqu(e.lcZ(20,26,"updateEmailForm.password.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(22,28,"updateEmailForm.password.placeholder")),e.uIk("aria-label",e.lcZ(23,30,"updateEmailForm.password.placeholder")),e.xp6(3),e.Q6J("control",r.form.get("password")),e.xp6(1),e.Q6J("routerLink",e.lcZ(26,32,e.DdM(38,P))),e.xp6(2),e.hij(" ",e.lcZ(28,34,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(31,36,"common.save")," "))},dependencies:[p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.ORR,g.rH,l.Ahv,l.X84,p.Ov,s.l2T,s.X$D],encapsulation:2,changeDetection:0}),o})(),Ue=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdateEmailComponent:{component:Ze,guards:[s.a1M],providers:[{provide:M,useClass:M,deps:[f.PF,s.Znh,s.IWp,s.e80,s.FUY]}]}}})],imports:[p.ez,i.u5,i.UX,l.Fme,s.bhT,g.Bz,s.LUR,l.Fym,l.Ird]}),o})(),E=(()=>{class o{constructor(t,r,n,c,d){this.userPasswordService=t,this.routingService=r,this.globalMessageService=n,this.authRedirectService=c,this.authService=d,this.busy$=new b.X(!1),this.isUpdating$=this.busy$.pipe((0,x.b)(m=>!0===m?this.form.disable():this.form.enable())),this.form=new i.nJ({oldPassword:new i.p4("",i.kI.required),newPassword:new i.p4("",[i.kI.required,l.kal.passwordValidator]),newPasswordConfirm:new i.p4("",i.kI.required)},{validators:l.kal.passwordsMustMatch("newPassword","newPasswordConfirm")})}updatePassword(){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const t=this.form.get("oldPassword")?.value,r=this.form.get("newPassword")?.value;this.userPasswordService.update(t,r).subscribe({next:()=>this.onSuccess(),error:n=>this.onError(n)})}onSuccess(){this.globalMessageService.add({key:"updatePasswordForm.passwordUpdateSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.authRedirectService?.setRedirectUrl(this.routingService.getUrl({cxRoute:"home"})),this.authService?.coreLogout().then(()=>{this.routingService.go({cxRoute:"login"})})}onError(t){t instanceof s.YPQ&&"AccessDeniedError"===t.details?.[0].type&&this.globalMessageService.add({key:"updatePasswordForm.accessDeniedError"},s.xUg.MSG_TYPE_ERROR),this.busy$.next(!1),this.form.reset()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.IWp),e.LFG(s.FUY),e.LFG(s.e80))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),Pe=(()=>{class o{constructor(t){this.service=t,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.updatePassword()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(E))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-update-password"]],hostAttrs:[1,"user-form"],decls:34,vars:45,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","password","name","oldPassword","formControlName","oldPassword","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","password","name","newPassword","formControlName","newPassword","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],["required","true","type","password","name","newPasswordConfirm","formControlName","newPasswordConfirm","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(t,r){1&t&&(e.YNc(0,pe,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label")(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e.ALo(9,"cxTranslate"),e._UZ(10,"cx-form-errors",4),e.qZA(),e.TgZ(11,"label")(12,"span",2),e._uU(13),e.ALo(14,"cxTranslate"),e.qZA(),e._UZ(15,"input",5),e.ALo(16,"cxTranslate"),e.ALo(17,"cxTranslate"),e._UZ(18,"cx-form-errors",4),e.qZA(),e.TgZ(19,"label")(20,"span",2),e._uU(21),e.ALo(22,"cxTranslate"),e.qZA(),e._UZ(23,"input",6),e.ALo(24,"cxTranslate"),e.ALo(25,"cxTranslate"),e._UZ(26,"cx-form-errors",4),e.qZA(),e.TgZ(27,"a",7),e.ALo(28,"cxUrl"),e._uU(29),e.ALo(30,"cxTranslate"),e.qZA(),e.TgZ(31,"button",8),e._uU(32),e.ALo(33,"cxTranslate"),e.qZA()()),2&t&&(e.Q6J("ngIf",e.lcZ(1,18,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,20,"updatePasswordForm.oldPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,22,"updatePasswordForm.oldPassword.placeholder")),e.uIk("aria-label",e.lcZ(9,24,"updatePasswordForm.oldPassword.placeholder")),e.xp6(3),e.Q6J("control",r.form.get("oldPassword")),e.xp6(3),e.Oqu(e.lcZ(14,26,"updatePasswordForm.newPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(16,28,"updatePasswordForm.newPassword.placeholder")),e.uIk("aria-label",e.lcZ(17,30,"updatePasswordForm.newPassword.placeholder")),e.xp6(3),e.Q6J("control",r.form.get("newPassword")),e.xp6(3),e.Oqu(e.lcZ(22,32,"updatePasswordForm.confirmPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(24,34,"updatePasswordForm.confirmPassword.placeholder")),e.uIk("aria-label",e.lcZ(25,36,"updatePasswordForm.confirmPassword.placeholder")),e.xp6(3),e.Q6J("control",r.form.get("newPasswordConfirm")),e.xp6(1),e.Q6J("routerLink",e.lcZ(28,38,e.DdM(44,P))),e.xp6(2),e.hij(" ",e.lcZ(30,40,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(33,42,"common.save")," "))},dependencies:[p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.ORR,l.Ahv,g.rH,l.X84,p.Ov,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),o})(),ye=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdatePasswordComponent:{component:Pe,guards:[s.a1M],providers:[{provide:E,useClass:E,deps:[f.LL,s.Znh,s.IWp,s.FUY,s.e80]}]}}})],imports:[p.ez,i.u5,i.UX,l.Fme,s.LUR,l.Fym,s.bhT,g.Bz,l.Ird]}),o})(),R=(()=>{class o{constructor(t,r){this.userProfile=t,this.globalMessageService=r,this.user$=this.userProfile.get().pipe((0,O.h)(n=>Boolean(n))),this.busy$=new b.X(!1),this.isUpdating$=this.user$.pipe((0,x.b)(n=>this.form.patchValue(n)),(0,A.w)(n=>this.busy$),(0,x.b)(n=>!0===n?this.form.disable():this.form.enable())),this.titles$=this.userProfile.getTitles(),this.form=new i.nJ({customerId:new i.p4(""),titleCode:new i.p4(""),firstName:new i.p4("",i.kI.required),lastName:new i.p4("",i.kI.required)})}updateProfile(){this.form.valid?(this.busy$.next(!0),this.userProfile.update(this.form.value).subscribe({next:()=>this.onSuccess(),error:t=>this.onError(t)})):this.form.markAllAsTouched()}onSuccess(){this.globalMessageService.add({key:"updateProfileForm.profileUpdateSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset()}onError(t){this.busy$.next(!1)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(f.aT),e.LFG(s.IWp))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),Te=(()=>{class o{constructor(t){this.service=t,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.titles$=this.service.titles$}onSubmit(){this.service.updateProfile()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(R))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-update-profile"]],hostAttrs:[1,"user-form"],decls:38,vars:46,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["formControlName","titleCode","id","title-select",3,"clearable","searchable","cxNgSelectA11y"],[3,"value",4,"ngFor","ngForOf"],["required","true","type","text","name","firstName","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","text","name","lastName","formControlName","lastName",1,"form-control",3,"placeholder"],["required","true","type","text","name","customerId","formControlName","customerId","readonly","",1,"form-control"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"],[3,"value"]],template:function(t,r){1&t&&(e.YNc(0,me,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label")(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e.TgZ(7,"ng-select",3),e.ALo(8,"cxTranslate"),e.YNc(9,fe,2,2,"ng-option",4),e.ALo(10,"async"),e.qZA()(),e.TgZ(11,"label")(12,"span",2),e._uU(13),e.ALo(14,"cxTranslate"),e.qZA(),e._UZ(15,"input",5),e.ALo(16,"cxTranslate"),e._UZ(17,"cx-form-errors",6),e.qZA(),e.TgZ(18,"label")(19,"span",2),e._uU(20),e.ALo(21,"cxTranslate"),e.qZA(),e._UZ(22,"input",7),e.ALo(23,"cxTranslate"),e._UZ(24,"cx-form-errors",6),e.qZA(),e.TgZ(25,"label")(26,"span",2),e._uU(27),e.ALo(28,"cxTranslate"),e.qZA(),e._UZ(29,"input",8)(30,"cx-form-errors",6),e.qZA(),e.TgZ(31,"a",9),e.ALo(32,"cxUrl"),e._uU(33),e.ALo(34,"cxTranslate"),e.qZA(),e.TgZ(35,"button",10),e._uU(36),e.ALo(37,"cxTranslate"),e.qZA()()),2&t&&(e.Q6J("ngIf",e.lcZ(1,19,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,21,"updateProfileForm.title")),e.xp6(2),e.Q6J("clearable",!1)("searchable",!1)("cxNgSelectA11y",e.VKq(43,D,e.lcZ(8,23,"updateProfileForm.title"))),e.xp6(2),e.Q6J("ngForOf",e.lcZ(10,25,r.titles$)),e.xp6(4),e.Oqu(e.lcZ(14,27,"updateProfileForm.firstName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(16,29,"updateProfileForm.firstName.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("firstName")),e.xp6(3),e.Oqu(e.lcZ(21,31,"updateProfileForm.lastName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(23,33,"updateProfileForm.lastName.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("lastName")),e.xp6(3),e.Oqu(e.lcZ(28,35,"updateProfileForm.customerId")),e.xp6(3),e.Q6J("control",r.form.get("lastName")),e.xp6(1),e.Q6J("routerLink",e.lcZ(32,37,e.DdM(45,P))),e.xp6(2),e.hij(" ",e.lcZ(34,39,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(37,41,"common.save")," "))},dependencies:[p.sg,p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.ORR,l.Ahv,g.rH,Z.w9,Z.jq,l.VnX,p.Ov,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),o})(),Se=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdateProfileComponent:{component:Te,guards:[s.a1M],providers:[{provide:R,useClass:R,deps:[f.aT,s.IWp]}]}}})],imports:[p.ez,i.u5,i.UX,l.Fme,s.LUR,l.Fym,g.Bz,s.bhT,Z.A0,l.LcC]}),o})(),Le=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[be,Se,Ue,ye,Ce,Ae,ve]}),o})();var G=u(7212),Fe=u(5359);const $=new e.OlP("UserProfileNormalizer"),Me=new e.OlP("UserProfileSerializer"),Ee=(new e.OlP("UserSerializer"),new e.OlP("UserSignUpSerializer")),Re=new e.OlP("TitleNormalizer");class Q{}let U=(()=>{class o{constructor(t){this.userProfileAdapter=t}update(t,r){return this.userProfileAdapter.update(t,r)}register(t){return this.userProfileAdapter.register(t)}registerGuest(t,r){return this.userProfileAdapter.registerGuest(t,r)}requestForgotPasswordEmail(t){return this.userProfileAdapter.requestForgotPasswordEmail(t)}resetPassword(t,r){return this.userProfileAdapter.resetPassword(t,r)}updateEmail(t,r,n){return this.userProfileAdapter.updateEmail(t,r,n)}updatePassword(t,r,n){return this.userProfileAdapter.updatePassword(t,r,n)}remove(t){return this.userProfileAdapter.close(t)}getTitles(){return this.userProfileAdapter.loadTitles()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Q))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),Y=(()=>{class o{constructor(t,r,n){this.userIdService=t,this.userProfileConnector=r,this.command=n,this.updateCommand=this.command.create(c=>this.userIdService.takeUserId(!0).pipe((0,A.w)(d=>this.userProfileConnector.updateEmail(d,c.password,c.newUid))),{strategy:s.flE.Queue})}update(t,r){return this.updateCommand.execute({password:t,newUid:r})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(s.XBV),e.LFG(U),e.LFG(s.VDr))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),j=(()=>{class o{constructor(t,r,n){this.userProfileConnector=t,this.userIdService=r,this.command=n,this.updateCommand=this.command.create(c=>this.userIdService.takeUserId(!0).pipe((0,N.q)(1),(0,A.w)(d=>this.userProfileConnector.updatePassword(d,c.oldPassword,c.newPassword)))),this.resetCommand=this.command.create(c=>this.userProfileConnector.resetPassword(c.token,c.password)),this.requestForgotPasswordEmailCommand=this.command.create(c=>this.userProfileConnector.requestForgotPasswordEmail(c.email))}update(t,r){return this.updateCommand.execute({oldPassword:t,newPassword:r})}reset(t,r){return this.resetCommand.execute({token:t,password:r})}requestForgotPasswordEmail(t){return this.requestForgotPasswordEmailCommand.execute({email:t})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(U),e.LFG(s.XBV),e.LFG(s.VDr))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),q=(()=>{class o{constructor(t,r,n,c,d,m,v){this.userAccountService=t,this.authService=r,this.userProfileConnector=n,this.eventService=c,this.userIdService=d,this.query=m,this.command=v,this.updateCommand=this.command.create(T=>this.userIdService.takeUserId(!0).pipe((0,A.w)(De=>this.userProfileConnector.update(De,T.details).pipe((0,x.b)(()=>{this.eventService.dispatch({user:T.details},G.x7)})))),{strategy:s.flE.Queue}),this.closeCommand=this.command.create(()=>this.userIdService.takeUserId(!0).pipe((0,A.w)(T=>this.userProfileConnector.remove(T).pipe((0,x.b)(()=>this.authService.logout()))))),this.titleQuery=this.query.create(()=>this.userProfileConnector.getTitles(),{reloadOn:[s.QRE]})}get(){return this.userAccountService.get()}update(t){return this.updateCommand.execute({details:t})}close(){return this.closeCommand.execute(void 0)}getTitles(){return this.titleQuery.get().pipe((0,_.U)(t=>t??[]))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(G.gf),e.LFG(s.e80),e.LFG(U),e.LFG(s.POd),e.LFG(s.XBV),e.LFG(s._7J),e.LFG(s.VDr))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),X=(()=>{class o{constructor(t,r,n,c,d){this.userProfile=t,this.userConnector=r,this.authService=n,this.command=c,this.store=d,this.registerCommand=this.command.create(({user:m})=>this.userConnector.register(m).pipe((0,x.b)(()=>{this.store.dispatch(new s.EJN.RegisterUserSuccess)}))),this.registerGuestCommand=this.command.create(m=>this.userConnector.registerGuest(m.guid,m.password).pipe((0,x.b)(v=>{this.authService.loginWithCredentials(v.uid,m.password)})))}register(t){return this.registerCommand.execute({user:t})}registerGuest(t,r){return this.registerGuestCommand.execute({guid:t,password:r})}getTitles(){return this.userProfile.getTitles()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(q),e.LFG(U),e.LFG(s.e80),e.LFG(s.VDr),e.LFG(Fe.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();const qe=[Y,j,q,X,{provide:f.PF,useExisting:Y},{provide:f.LL,useExisting:j},{provide:f.aT,useExisting:q},{provide:f.zm,useExisting:X}];let Ie=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[U,...qe]}),o})();var h=u(529),C=u(1737),w=u(7221);const ke={backend:{occ:{endpoints:{userRegister:"users",userForgotPassword:"forgottenpasswordtokens",userResetPassword:"resetpassword",userUpdateLoginId:"users/${userId}/login",userUpdatePassword:"users/${userId}/password",titles:"titles"}}}},z={"Content-Type":"application/json"},y={"Content-Type":"application/x-www-form-urlencoded"};let Ne=(()=>{class o{constructor(t,r,n){this.http=t,this.occEndpoints=r,this.converter=n,this.logger=(0,e.f3M)(s.mQy)}update(t,r){const n=this.occEndpoints.isConfigured("userUpdateProfile")?"userUpdateProfile":"user",c=this.occEndpoints.buildUrl(n,{urlParams:{userId:t}});return r=this.converter.convert(r,Me),this.http.patch(c,r).pipe((0,w.K)(d=>(0,C._)((0,s.cxH)(d,this.logger))))}register(t){const r=this.occEndpoints.buildUrl("userRegister");let n=new h.WM({...z});return n=s.Fox.createHeader(s._Re,!0,n),t=this.converter.convert(t,Ee),this.http.post(r,t,{headers:n}).pipe((0,w.K)(c=>(0,C._)((0,s.cxH)(c,this.logger))),this.converter.pipeable($))}registerGuest(t,r){const n=this.occEndpoints.buildUrl("userRegister");let c=new h.WM({...y});c=s.Fox.createHeader(s._Re,!0,c);const d=(new h.LE).set("guid",t).set("password",r);return this.http.post(n,d,{headers:c}).pipe((0,w.K)(m=>(0,C._)((0,s.cxH)(m,this.logger))),this.converter.pipeable($))}requestForgotPasswordEmail(t){const r=this.occEndpoints.buildUrl("userForgotPassword"),n=(new h.LE).set("userId",t);let c=new h.WM({...y});return c=s.Fox.createHeader(s._Re,!0,c),this.http.post(r,n,{headers:c}).pipe((0,w.K)(d=>(0,C._)((0,s.cxH)(d,this.logger))))}resetPassword(t,r){const n=this.occEndpoints.buildUrl("userResetPassword");let c=new h.WM({...z});return c=s.Fox.createHeader(s._Re,!0,c),this.http.post(n,{token:t,newPassword:r},{headers:c}).pipe((0,w.K)(d=>(0,C._)((0,s.cxH)(d,this.logger))))}updateEmail(t,r,n){const c=this.occEndpoints.buildUrl("userUpdateLoginId",{urlParams:{userId:t}}),d=(new h.LE).set("password",r).set("newLogin",n),m=new h.WM({...y});return this.http.put(c,d,{headers:m}).pipe((0,w.K)(v=>(0,C._)((0,s.cxH)(v,this.logger))))}updatePassword(t,r,n){const c=this.occEndpoints.buildUrl("userUpdatePassword",{urlParams:{userId:t}}),d=(new h.LE).set("old",r).set("new",n),m=new h.WM({...y});return this.http.put(c,d,{headers:m}).pipe((0,w.K)(v=>(0,C._)((0,s.cxH)(v,this.logger))))}close(t){const r=this.occEndpoints.isConfigured("userCloseAccount")?"userCloseAccount":"user",n=this.occEndpoints.buildUrl(r,{urlParams:{userId:t}});return this.http.delete(n).pipe((0,w.K)(c=>(0,C._)((0,s.cxH)(c,this.logger))))}loadTitles(){const t=this.occEndpoints.buildUrl("titles");return this.http.get(t).pipe((0,w.K)(r=>(0,C._)((0,s.cxH)(r,this.logger))),(0,_.U)(r=>r.titles??[]),this.converter.pipeableMany(Re))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(h.eN),e.LFG(s.Lz0),e.LFG(s.IXI))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})(),Oe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,s.i51)(ke),{provide:Q,useClass:Ne}]}),o})(),Je=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[Ie,Oe,Le]}),o})()}}]);